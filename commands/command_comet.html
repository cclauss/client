

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cloudmesh Comet CLI &mdash; cloudmesh_client 4.7.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="cloudmesh_client 4.7.3 documentation" href="../index.html"/>
        <link rel="up" title="User Manual" href="index.html"/>
        <link rel="next" title="Reservation Command" href="command_reservation.html"/>
        <link rel="prev" title="Hpc Command" href="command_hpc.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> cloudmesh_client
          

          
          </a>

          
            
            
              <div class="version">
                4.7.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prefix.html">Prefix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">Short Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_card.html">Reference Card</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../comet.html">Comet Virtual Cluster</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manuals</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#shell-commands">Shell Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#cloud-commands">Cloud Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hpc-commands">HPC Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#comet-commands">Comet Commands</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Cloudmesh Comet CLI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#teminology">Teminology</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#commands">Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#proposed-commands">Proposed Commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../man/man.html">Commands</a></li>
</ul>
<p class="caption"><span class="caption-text">Teaching</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exercises.html">Exercises</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/comet_cloudmesh.html">Comet Cloudmesh Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/comet_bigdata.html">Comet Big Data Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking.html">Hacking</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Appendix</a></li>
</ul>
<p class="caption"><span class="caption-text">Future and Old</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stack.html">Stack</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code/cloudmesh_client.html">cloudmesh_client package</a></li>
</ul>
<p class="caption"><span class="caption-text">Todo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">ToDos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon.html">Using python 2 and 3 for development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon.html#python-guidelines">Python Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cloudmesh_client</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User Manual</a> &raquo;</li>
        
      <li>Cloudmesh Comet CLI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/commands/command_comet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cloudmesh-comet-cli">
<span id="comet-command"></span><h1>Cloudmesh Comet CLI<a class="headerlink" href="#cloudmesh-comet-cli" title="Permalink to this headline">¶</a></h1>
<p>We developed a command line based client tool for users to access Comet
VC easily and securely. The CLI is part of a larger effort called
Cloudmesh Client toolkit, which provides command line and shell
interface of accessing heterogeneous clouds, clusters, and workstations
right from the users’ computers. By utilizing this client tool, Comet VC
users can access all capabilities to manage their virtual cluster, while
bypassing the security concerns and the complexity of programming with
the Comet nucleus API.</p>
<div class="section" id="teminology">
<h2>Teminology<a class="headerlink" href="#teminology" title="Permalink to this headline">¶</a></h2>
<p>We use in this section the following terminology:</p>
<dl class="docutils">
<dt>computeset:</dt>
<dd>A group of compute nodes started together and being in some state
(submitted, started, finished, failed). Each compute node can only
belong to 1 computesets in submitted or active state.</dd>
<dt>frontend:</dt>
<dd>A node with limited computational resources used to manage a
virtual cluster. Frontends run 24/7, have a public interface and a
private interface. The public interface provides outside access to
the virtual cluster while the private interface is used to
manage/install the compute nodes.</dd>
<dt>image:</dt>
<dd>A file containing the contents and structure (ISO9660) of a disk
volume which can be attached as a cdrom to a node.</dd>
<dt>console:</dt>
<dd>An interactive representation of the screen of a virtual cluster
node (text or graphical) provided to assist with node installation
and management.</dd>
<dt>virtual cluster:</dt>
<dd>A virtual cluster is a loosely or tightly connected network of virtual
computers managed together by a virtual cluster administrator.</dd>
<dt>node:</dt>
<dd>The term node is used to refer to individual computers in a
virtual cluster.</dd>
<dt>image attach:</dt>
<dd>Attach is an action applied to a node / image pair whereby the
contents of the image are made available to a node on the next
power on.</dd>
<dt>image detach:</dt>
<dd>Detach is an action applied to a node / image pair whereby the
contents of the image are made unavailable to the node on the next
power on.</dd>
</dl>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Cloudmesh Comet CLI is developed using Python. The installation is
starightforward and easy:</p>
<pre class="highlight"><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">pip install cloudmesh_client</span>
</pre><p>Both Python 2.7 and 3.5 is supported. You are HIGHLY recommended to use
a virtualenv based environment to install and use this toolkit.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The configuration of the cloudmesh client is done semi automatically
for you.  All you have to do after the installation is to call
cloudmesh client once.</p>
<p>This is done best with the command:</p>
<pre class="highlight"><span class="prompt1">cm <span class="nb">help</span></span>
</pre><p>This will automatically generate a template configuration file at:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">~/.</span><span class="n">cloudmesh</span><span class="o">/</span><span class="n">cloudmesh</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>Next you can initiate the configuration file:</p>
<pre class="highlight"><span class="prompt1">cm comet init</span>
</pre><p>Follow the prompt to configure and select endpoint, and initialize the
auth settings by provide your username and password. Once you are
successfully authenticated it will retrieve the api key and secret and
configure the cloudmesh.yaml with proper api auth information. Then you
will be able to use the commands to manage your comet virtual cluster.</p>
<p><strong>For the use of the Comet VC production system, you need to use the OTP
generated by your assigned YubiKey. You need to have the key plugged in,
and upon the request of your password, type your PIN first, and then tap
your key.</strong></p>
<p><strong>Console access of nodes requires 2-factor Auth as well, so please have
your YubiKey ready for console access</strong></p>
</div>
<div class="section" id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h2>
<p>Comet CLI supports accessing multiple nucleus service endpoint, e.g.,
DEV system or Production system. You will know which system to use after
your VC is setup. To check which system you are currently accessing,
run this:</p>
<pre class="highlight"><span class="prompt1">cm comet active</span>
</pre><p>Or change to another system to interact with, e.g.:</p>
<pre class="highlight"><span class="prompt1">cm comet active production</span>
</pre><p>Next we list a number of important commands from the CLI that will
help you managing your comet virtual clusters.</p>
<div class="section" id="getting-information-of-your-cluster-s-nodes-computesets-etc">
<h3>Getting information of your cluster(s); nodes; computesets; etc.<a class="headerlink" href="#getting-information-of-your-cluster-s-nodes-computesets-etc" title="Permalink to this headline">¶</a></h3>
<p>List all clusters owned by the authenticated identity (summarized
format):</p>
<pre class="highlight"><span class="prompt1">cm comet ll</span>
</pre><p>List all clusters owned by the authenticated identity (detailed
list):</p>
<pre class="highlight"><span class="prompt1">cm comet cluster</span>
</pre><p>List a cluster by name (we use here vc2 as example):</p>
<pre class="highlight"><span class="prompt1">cm comet cluster vc2</span>
</pre><p>Cluster listing view also supports other output format, e.g. json,
csv, etc.:</p>
<pre class="highlight"><span class="prompt1">cm comet cluster vc2 --format<span class="o">=</span>csv</span>
</pre><p>This can be useful for scripting.</p>
<p>List all defined computesets:</p>
<pre class="highlight"><span class="prompt1">cm comet computeset</span>
</pre><p>List one computeset:</p>
<pre class="highlight"><span class="prompt1">cm comet computeset <span class="m">63</span></span>
</pre><p>To obtain the detailed information of a node:</p>
<pre class="highlight"><span class="prompt1">cm comet node info vc2</span>
</pre><p>Gives your the information of the vc2 frontnode. This includes essential
network configuration information if you want to rebuild the frontend
node.</p>
<pre class="highlight"><span class="prompt1">cm comet node info vc2 vm-vc2-0</span>
</pre><p>Gives the detailed information of the specified compute node.</p>
<p>By default it returned information in a table format. It also accepts
the –format=FROMAT parameter so the output can be easily parsed while
being used in scripting (FORMAT could be one of csv, json, yaml).</p>
</div>
<div class="section" id="power-management-of-frontend-node">
<h3>Power management of frontend node:<a class="headerlink" href="#power-management-of-frontend-node" title="Permalink to this headline">¶</a></h3>
<p>Power on the front end node of the specified cluster:</p>
<pre class="highlight"><span class="prompt1">cm comet power on vc2</span>
</pre><p>To power if off:</p>
<pre class="highlight"><span class="prompt1">cm comet power off vc2</span>
</pre><p>You can also reboot/reset/shutdown the fronend using the same
syntax, e.g., to reboot:</p>
<pre class="highlight"><span class="prompt1">cm comet power reboot vc2</span>
</pre><p>Please note running frontend node itself would not charge you any
allocations.</p>
</div>
<div class="section" id="resource-allocation-and-tear-down">
<h3>Resource allocation and tear down:<a class="headerlink" href="#resource-allocation-and-tear-down" title="Permalink to this headline">¶</a></h3>
<p>The requested cluster/VMs has to be started by requesting physical
allocations. This will charge your allocation based on number of
nodes and the walltime you requested.</p>
<p><strong>Please note that each VM you requested corresponds to 24 cores (You
have the exclusive access to the whole physical node), thus one VM node
hour is equivalent to 24 SUs. So please TERMINATE the resources (see
below) if you don’t actively use them. Keeping them idle (even SHUT OFF)
will still cost your allocation.</strong></p>
<p><strong>Currently for the DEV resources you are not charged for any usage.
Please use the DEV resource to develop/test your application/workflow,
and move to the production for the actual usage. Please terminate the
requested compute set(s) if you are not actively using them to free the
resources so other users can use them as well.</strong></p>
<p>Start a set of compute nodes in cluster vc2:</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-3<span class="o">]</span></span>
</pre><p>This will request the nodes for a default period of time and power on
them (currently default as 2 days).</p>
<p>To request for a customized time period, use –walltime parameter.
E.g., 100m (100 minutes), 6h (6 hours), 2d (2 days) , 1w (1 week):</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-3<span class="o">]</span> --walltime<span class="o">=</span>6h</span>
</pre><p>The above will put the request under the one allocation associated
with the cluster.  If your cluster have more than one allocations,
use –allocation parameter:</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-3<span class="o">]</span> --allocation<span class="o">=</span>YOUR_ALLOCATION</span>
</pre><p>If you have more allocations, but does not specify via CLI, you will
see a list of allocations to choose from to use.</p>
<p>You can also request a group of N nodes, if there is enough resource:</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 --count<span class="o">=</span><span class="m">4</span></span>
</pre><p>The comet system will find 4 available nodes from the specified
cluster and start them as one computeset.</p>
<p>You can also start a single-node computeset:</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 vm-vc2-<span class="o">[</span><span class="m">7</span><span class="o">]</span></span>
</pre><p>or simply:</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 vm-vc2-7</span>
</pre><p>To power down all running nodes from an active computeset and also
free the allocated resources:</p>
<pre class="highlight"><span class="prompt1">cm comet terminate <span class="m">123</span></span>
</pre><p>This will gracefully shutdown the nodes in the group identified by
computeset 123, and also free the unused allocations. A computeset
will be teared down automatically when it reaches its requested
walltime.</p>
<p><strong>Please note you have to terminate the requested resources
as such so it stops charging your account for the usage.</strong></p>
</div>
<div class="section" id="power-management-of-compute-nodes">
<h3>Power management of compute nodes:<a class="headerlink" href="#power-management-of-compute-nodes" title="Permalink to this headline">¶</a></h3>
<p>You can power off and back on individual nodes from a cluster,
without affecting other running nodes in the computesets. E.g.:</p>
<pre class="highlight"><span class="prompt1">cm comet power off vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-7<span class="o">]</span></span>
</pre><p>and then:</p>
<pre class="highlight"><span class="prompt1">cm comet power on vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-7<span class="o">]</span></span>
</pre><p>or shutdown gracefully a group of nodes:</p>
<pre class="highlight"><span class="prompt1">cm comet power shutdown vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-3<span class="o">]</span></span>
</pre><p>Please note even if you powered off all nodes from an active
computeset, the computeset itself along with the associated physical
resource is still active and can only be accessed exclusively by you
till the requested walltime is reached. During this time you can
freely power the nodes back on and off.</p>
<p><strong>Please be reminded that your account will still be charged in this
case until you terminate the computeset as described earlier.</strong></p>
<p><strong>Please note that the node disks are persisted silently on the background
periodically, or when you shut them off gracefully (‘cm comet terminate’
or ‘cm comet power shutdown’). So the next time you start the node, or
powered if on, you can start with where you have left.</strong></p>
</div>
<div class="section" id="getting-console-access">
<h3>Getting Console access<a class="headerlink" href="#getting-console-access" title="Permalink to this headline">¶</a></h3>
<p>Get console of the frontend:</p>
<pre class="highlight"><span class="prompt1">cm comet console vc2</span>
</pre><p>Get console of a running compute node:</p>
<pre class="highlight"><span class="prompt1">cm comet console vc2 vm-vc2-0</span>
</pre><p><strong>Please note the console access requires 2-factor auth.</strong>
The commands will ask your comet nucleus username (if not set previously)
and password, and you will need your Yubikey for the access.</p>
<p>Once you have passed this extra step of auth, it will print out a shortlived
URL for accessing the console of the node requested. It will also pop open a
browser window if a supported OS/browser is detected. In OSX it will use the
system default browser to display the console; and in Linux environment it
will try to use firefox.</p>
<p>You can also get only the URL directly by calling:</p>
<pre class="highlight"><span class="prompt1">cm comet console --link vc2</span>
</pre></div>
<div class="section" id="system-image-management">
<h3>System image management<a class="headerlink" href="#system-image-management" title="Permalink to this headline">¶</a></h3>
<p>Get the list of images that are available to you:</p>
<pre class="highlight"><span class="prompt1">cm comet iso list</span>
</pre><p>Upload an image to the public shared folder:</p>
<pre class="highlight"><span class="prompt1">cm comet iso upload /path/to/your/image.iso</span>
</pre><p>Or with a specified new image name:</p>
<pre class="highlight"><span class="prompt1">cm comet iso upload /path/to/your/image.iso --imagename<span class="o">=</span>newimagename.iso</span>
</pre><p>Attach an image to the frontend, by specifying the exact image name, or the index
of the image in the iso list:</p>
<pre class="highlight"><span class="prompt1">cm comet iso attach newimagename.iso vc2</span>
<span class="prompt1">cm comet iso attach <span class="m">6</span> vc2</span>
</pre><p>Or to a compute node:</p>
<pre class="highlight"><span class="prompt1">cm comet iso attach newimagename.iso vc2 vm-vc2-0</span>
</pre><p>To detach the attached iso image from frontend node:</p>
<pre class="highlight"><span class="prompt1">cm comet iso detach vc2</span>
</pre><p>Or from a compute node:</p>
<pre class="highlight"><span class="prompt1">cm comet iso detach vc2 vm-vc2-0</span>
</pre><p>Image attaching/detaching also works on compute nodes in bulk:</p>
<pre class="highlight"><span class="prompt1">cm comet iso attach newimagename.iso vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-4<span class="o">]</span></span>
</pre><pre class="highlight"><span class="prompt1">cm comet iso detach vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-4<span class="o">]</span></span>
</pre><p>Please note image attaching/detaching will only take effect <strong>AFTER you
hard reboot the node (power off and then power on)</strong>.</p>
</div>
<div class="section" id="other-commands">
<h3>Other commands:<a class="headerlink" href="#other-commands" title="Permalink to this headline">¶</a></h3>
<p>You can rename a compute node, or a list of nodes in batch:</p>
<pre class="highlight"><span class="prompt1">cm comet node rename vc2 vm-vc2-0 mynode0</span>
</pre><pre class="highlight"><span class="prompt1">cm comet node rename vc2 vm-vc2-<span class="o">[</span><span class="m">0</span>-7<span class="o">]</span> newname-<span class="o">[</span><span class="m">0</span>-7<span class="o">]</span></span>
</pre><p>Please use hostlist format to specify the list of OLDNAMES AND
NEWNAMES</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="command_reservation.html" class="btn btn-neutral float-right" title="Reservation Command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="command_hpc.html" class="btn btn-neutral" title="Hpc Command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Gregor von Laszewski.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'4.7.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>