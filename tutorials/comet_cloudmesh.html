

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Comet Cloudmesh Tutorial &mdash; cloudmesh_client 4.3.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="cloudmesh_client 4.3.1 documentation" href="../index.html"/>
        <link rel="next" title="Comet Big Data Tutorial" href="comet_bigdata.html"/>
        <link rel="prev" title="Exercises" href="../exercises.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> cloudmesh_client
          

          
          </a>

          
            
            
              <div class="version">
                4.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prefix.html">Prefix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">Short Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_card.html">Reference Card</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../comet.html">Comet Virtual Cluster</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../man/man.html">Commands</a></li>
</ul>
<p class="caption"><span class="caption-text">Teaching</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exercises.html">Exercises</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Comet Cloudmesh Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#virtual-box">Virtual Box</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-cloudmesh">Configure Cloudmesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="#instalation-with-pip">Instalation with Pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-access-to-your-cluster">Getting access to your cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-install-the-front-end-node">Example: Install the front-end node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finishing-front-end-setup">Finishing Front-end setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-the-front-end-node">Configuring the front-end node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-install-compute-nodes">Example: Install Compute Nodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="comet_bigdata.html">Comet Big Data Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking.html">Hacking</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Appendix</a></li>
</ul>
<p class="caption"><span class="caption-text">Future and Old</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code/cloudmesh_client.html">cloudmesh_client package</a></li>
</ul>
<p class="caption"><span class="caption-text">Todo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">ToDos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon.html">Using python 2 and 3 for development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hackathon.html#python-guidelines">Python Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">cloudmesh_client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Comet Cloudmesh Tutorial</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/comet_cloudmesh.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="comet-cloudmesh-tutorial">
<h1>Comet Cloudmesh Tutorial<a class="headerlink" href="#comet-cloudmesh-tutorial" title="Permalink to this headline">¶</a></h1>
<p>Setup Cloudmesh Client on Ubuntu Desktop in Virtualbox</p>
<div class="section" id="virtual-box">
<h2>Virtual Box<a class="headerlink" href="#virtual-box" title="Permalink to this headline">¶</a></h2>
<p><strong>Step 1:</strong> For convenience we will be using Ubuntu Xenial in this demo to
install the Cloudmesh client on it. Please make sure you have</p>
<ul class="simple">
<li><a class="reference external" href="https://www.virtualbox.org">VirtualBox</a> installed (<a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">downloads page</a>).</li>
</ul>
<p><strong>Step 2:</strong> Next, please download the</p>
<ul class="simple">
<li><a class="reference external" href="http://www.ubuntu.com/download">Ubuntu desktop ISO</a>.</li>
</ul>
<p>and remember the location where you downloaded it. You will need that location later.</p>
<p><strong>Step 3:</strong> Create VirtualBox, create a new VM (Ubuntu, 64bit)</p>
<p><strong>Step 4:</strong> Start the box. When asked for the ISO, use the folder icon to browse to the location of the downloaded image.</p>
<p><strong>Step 5:</strong> Start and configure the system. Note in case the last step does not return, shut down or terminate the VM and restart it.</p>
<p><strong>Step 6:</strong> Once you have logged into the vm, start a terminal by clicking on the cog and type in <em>terminal</em></p>
<p><strong>Step 7:</strong> (optional) You may want to enable the vm guest addition and enable bidirectional shared clipboard and drag and drop. You may have
to restart the vm so that these changes take effect.</p>
<p><strong>Step 8:</strong> Install cloudmesh. Paste and copy between host and vm, as well as .</p>
<pre class="highlight"><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">wget -O cm-setup.sh http://bit.ly/cloudmesh-client-xenial</span>
<span class="prompt1">sh cm-setup.sh</span>
</pre><p>The script has the following contents:</p>
<pre class="highlight"><span class="prompt1">sudo apt install python-pip -y</span>
<span class="prompt1">sudo apt install libssl-dev -y</span>
<span class="prompt1">sudo pip install pip -U</span>
<span class="prompt1">sudo apt install git -y</span>
<span class="prompt1">sudo pip install ansible</span>
<span class="prompt1">sudo pip install cloudmesh_client</span>
<span class="prompt1">python --version</span>
<span class="prompt1">pip --version</span>
<span class="prompt1">git –version</span>
</pre></div>
<div class="section" id="configure-cloudmesh">
<h2>Configure Cloudmesh<a class="headerlink" href="#configure-cloudmesh" title="Permalink to this headline">¶</a></h2>
<p>Next, we need to configure cloudmesh. We will only use a fraction of cloudmesh
capabilities for this tutorial that is focused on using comet</p>
<pre class="highlight"><span class="prompt1">ssh-keygen</span>
<span class="prompt1">cm</span>
<span class="prompt1">cm version</span>
</pre></div>
<div class="section" id="instalation-with-pip">
<h2>Instalation with Pip<a class="headerlink" href="#instalation-with-pip" title="Permalink to this headline">¶</a></h2>
<p>Installing in a virtualenv is highly recommended.</p>
<pre class="highlight"><span class="prompt1">pip install cloudmesh_client</span>
<span class="prompt1">cm <span class="nb">help</span></span>
<span class="prompt1">cm comet init</span>
</pre></div>
<div class="section" id="getting-access-to-your-cluster">
<h2>Getting access to your cluster<a class="headerlink" href="#getting-access-to-your-cluster" title="Permalink to this headline">¶</a></h2>
<p>Access your virtual cluster (vc)</p>
<p>The cluster information can be obtained with the following commands:</p>
<pre class="highlight"><span class="prompt1">cm comet cluster ll</span>
<span class="prompt1">cm comet cluster</span>
<span class="prompt1">cm comet cluster vc2</span>
</pre><p>The list of ISO images that are currently available can be obtained with:</p>
<pre class="highlight"><span class="prompt1">cm comet iso list</span>
</pre></div>
<div class="section" id="example-install-the-front-end-node">
<h2>Example: Install the front-end node<a class="headerlink" href="#example-install-the-front-end-node" title="Permalink to this headline">¶</a></h2>
<p>Find an iso and attach</p>
<pre class="highlight"><span class="prompt1">cm comet iso list</span>
</pre><p>This will return:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="mi">1</span><span class="p">:</span> <span class="n">CentOS</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">NetInstall</span><span class="o">-</span><span class="mf">1511.</span><span class="n">iso</span>
 <span class="mi">2</span><span class="p">:</span> <span class="n">CentOS</span><span class="o">-</span><span class="mf">6.8</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">netinstall</span><span class="o">.</span><span class="n">iso</span>
 <span class="mi">3</span><span class="p">:</span> <span class="n">kernel</span><span class="o">-</span><span class="mf">6.2</span><span class="o">-</span><span class="mf">0.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">disk1</span><span class="o">.</span><span class="n">iso</span>
 <span class="mi">4</span><span class="p">:</span> <span class="n">systemrescuecd</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mf">4.2</span><span class="o">.</span><span class="mf">0.</span><span class="n">iso</span>
 <span class="mi">5</span><span class="p">:</span> <span class="n">base</span><span class="o">+</span><span class="n">kernel</span><span class="o">+</span><span class="n">kvm</span><span class="o">+</span><span class="n">os</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">disk1</span><span class="o">.</span><span class="n">iso</span>
 <span class="mi">6</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">iso</span>
 <span class="mi">7</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="mf">15.04</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">iso</span>
 <span class="mi">8</span><span class="p">:</span> <span class="n">CentOS</span><span class="o">-</span><span class="mf">6.8</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">LiveDVD</span><span class="o">.</span><span class="n">iso</span>
 <span class="mi">9</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="mf">16.04</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">iso</span>
<span class="mi">10</span><span class="p">:</span> <span class="n">CentOS</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">LiveGNOME</span><span class="o">-</span><span class="mf">1511.</span><span class="n">iso</span>
</pre></div>
</div>
<p>Next we attach an iso. YOu can use either the name of the iso, or simply the id</p>
<pre class="highlight"><span class="prompt1">cm comet iso attach <span class="m">6</span> vc2</span>
</pre><p>Let us check the status of the server.</p>
<pre class="highlight"><span class="prompt1">cm comet cluster vc2</span>
</pre><p>If it is already running, please power if off so the iso attach could take effect:</p>
<pre class="highlight"><span class="prompt1">cm comet power off vc2</span>
</pre><p>Now we need to power on the server</p>
<pre class="highlight"><span class="prompt1">cm comet power on vc2</span>
</pre><p>To see what is happening on the server, we can attach a console to follow and complete the setup of the OS</p>
<pre class="highlight"><span class="prompt1">cm comet console vc2</span>
</pre><p>Screenshots for the frontend node configuration are given next:</p>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="../_images/00_install_start.png"><img alt="screenshot" src="../_images/00_install_start.png" style="width: 647.0px; height: 489.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Install ubuntu server</span></p>
</div>
<div class="figure" id="id2">
<a class="reference internal image-reference" href="../_images/01_NIC.png"><img alt="screenshot" src="../_images/01_NIC.png" style="width: 811.0px; height: 612.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Configure the network. DHCP is configured on <cite>eth1</cite> (the public interface)</span></p>
</div>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="../_images/20_hostname.png"><img alt="screenshot" src="../_images/20_hostname.png" style="width: 810.0px; height: 609.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Set the hostname</span></p>
</div>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../_images/22_user_password_creation.png"><img alt="screenshot" src="../_images/22_user_password_creation.png" style="width: 806.0px; height: 611.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Set up the non-privileged user account, including a strong password</span></p>
</div>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../_images/08_partition.png"><img alt="screenshot" src="../_images/08_partition.png" style="width: 813.0px; height: 609.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Partition the disk</span></p>
</div>
<div class="figure" id="id6">
<a class="reference internal image-reference" href="../_images/09_services_packages.png"><img alt="screenshot" src="../_images/09_services_packages.png" style="width: 811.0px; height: 611.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Select OpenSSH using the space bar and then tab to Continue</span></p>
</div>
<div class="figure" id="id7">
<a class="reference internal image-reference" href="../_images/10_complete.png"><img alt="screenshot" src="../_images/10_complete.png" style="width: 809.0px; height: 608.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Complete the installation</span></p>
</div>
<div class="figure" id="id8">
<a class="reference internal image-reference" href="../_images/11_complete_console_expired.png"><img alt="screenshot" src="../_images/11_complete_console_expired.png" style="width: 810.0px; height: 609.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: Press CONTINUE (we&#8217;ll detach the ISO later)</span></p>
</div>
<div class="figure" id="id9">
<a class="reference internal image-reference" href="../_images/12_reboot_cd.png"><img alt="screenshot" src="../_images/12_reboot_cd.png" style="width: 650.0px; height: 489.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: The machine will be rebooted. Allow it to start booting from the CDROM again.</span></p>
</div>
<div class="figure" id="id10">
<a class="reference internal image-reference" href="../_images/13_reboot_cd_choose_hd.png"><img alt="screenshot" src="../_images/13_reboot_cd_choose_hd.png" style="width: 648.0px; height: 486.0px;" /></a>
<p class="caption"><span class="caption-text">Figure: From the CDROM boot menu, choose to boot from hard disk</span></p>
</div>
</div>
<div class="section" id="finishing-front-end-setup">
<h2>Finishing Front-end setup<a class="headerlink" href="#finishing-front-end-setup" title="Permalink to this headline">¶</a></h2>
<p>At end of the installation, click <strong>complete</strong> to finish the setup. The node will
reboot into the OS installation CD again, but now choose &#8216;boot from first hard disk&#8217;
option from the booting menu. This ensure the node boots into the newly installed OS,
while having the OS installation CD still attached (we will need the CD again in the
later steps).</p>
<p>Once the node is back on, you can now login and configure the cluster from your laptop/desktop:</p>
<pre class="highlight"><span class="prompt1">cm comet console vc2</span>
</pre><p>YOu can also ssh into the machine after it is configures with the usual ssh commands while
using your login name that you set up and specify your cluster name.</p>
<pre class="highlight"><span class="prompt1">ssh USER@vct&lt;NN&gt;.sdsc.edu</span>
</pre></div>
<div class="section" id="configuring-the-front-end-node">
<h2>Configuring the front-end node<a class="headerlink" href="#configuring-the-front-end-node" title="Permalink to this headline">¶</a></h2>
<p>On your managing machine where Cloudmesh client tools is installed:</p>
<pre class="highlight"><span class="prompt1">wget -O cmutil.py http://bit.ly/vc-cmutil</span>
<span class="prompt1">python cmutil.py nodesfile vct&lt;NN&gt;</span>
<span class="prompt1">scp vcn*.txt &lt;USER&gt;@vct&lt;NN&gt;.sdsc.edu:~/</span>
</pre><p>On vc front-end node:</p>
<pre class="highlight"><span class="prompt1">wget -O deploy.sh http://bit.ly/vc-deployment</span>
<span class="prompt1">chmod +x deploy.sh</span>
<span class="prompt1">sudo ./deploy.sh</span>
</pre></div>
<div class="section" id="example-install-compute-nodes">
<h2>Example: Install Compute Nodes<a class="headerlink" href="#example-install-compute-nodes" title="Permalink to this headline">¶</a></h2>
<p>Compute node setup</p>
<pre class="highlight"><span class="prompt1">cm comet start vc2 vm-vc2-<span class="o">[</span>1-2<span class="o">]</span></span>
</pre><p>Takes about 15~20 minutes. Once done, the node will be shutoff.</p>
<p>Once you see the boot question in your console log, please change it to
Changing to localboot. Do this on the front-end node:</p>
<pre class="highlight"><span class="prompt1"><span class="nb">cd</span> <span class="nv">$HOME</span></span>
<span class="prompt1">wget -O cmutil.py http://bit.ly/vc-cmutil</span>
<span class="prompt1">python cmutil.py setboot <span class="nv">$HOSTNAME</span> &lt;NODE&gt; <span class="nv">net</span><span class="o">=</span><span class="nb">false</span></span>
</pre><p>Then on your managing host where Cloudmesh client is installed:</p>
<pre class="highlight"><span class="prompt1">cm comet power on vc2 vm-vc2-<span class="o">[</span>1-2<span class="o">]</span></span>
</pre><p>Wait the compute nodes to be booted on, which can be checked by:</p>
<pre class="highlight"><span class="prompt1">cm comet cluster vct&lt;NN&gt;</span>
</pre><p>to see if the state (2nd column) of the nodes is &#8216;active&#8217;.</p>
<p>Once the compute nodes are on, run these on the front-end node:</p>
<pre class="highlight"><span class="prompt1"><span class="nb">cd</span> <span class="nv">$HOME</span>/comet-vc-tutorial/</span>
<span class="prompt1">./key_setup.sh</span>
</pre><p>This would setup the key, authorized keys, and known hosts files on the nodes.</p>
<p>Login to compute nodes from front-end, and run your app.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the production we use two factor authentication with yubikeys.
To simplify the the tutorial we use username and  password access for the
isolated teaching environment. When utilizing the production version you
will need to get in contact with the comet staff. You must have a valid
XSEDE allocation.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="comet_bigdata.html" class="btn btn-neutral float-right" title="Comet Big Data Tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../exercises.html" class="btn btn-neutral" title="Exercises" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Gregor von Laszewski.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'4.3.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>