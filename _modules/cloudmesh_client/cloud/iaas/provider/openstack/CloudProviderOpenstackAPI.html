

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI &mdash; cloudmesh_client 4.3.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="cloudmesh_client 4.3.0 documentation" href="../../../../../../index.html"/>
        <link rel="up" title="cloudmesh_client" href="../../../../../cloudmesh_client.html"/> 

  
  <script src="../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> cloudmesh_client
          

          
          </a>

          
            
            
              <div class="version">
                4.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../prefix.html">Prefix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../introduction.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">Short Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../reference_card.html">Reference Card</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../scripts.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../comet.html">Comet Virtual Cluster</a></li>
</ul>
<p class="caption"><span class="caption-text">User Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../commands/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../man/man.html">Commands</a></li>
</ul>
<p class="caption"><span class="caption-text">Teaching</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../exercises.html">Exercises</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Manuals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../hacking.html">Hacking</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../appendix.html">Appendix</a></li>
</ul>
<p class="caption"><span class="caption-text">Future and Old</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../docker.html">Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../code/cloudmesh_client.html">cloudmesh_client package</a></li>
</ul>
<p class="caption"><span class="caption-text">Todo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../todo.html">ToDos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../hackathon.html">Using python 2 and 3 for development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../hackathon.html#python-guidelines">Python Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../../index.html">cloudmesh_client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../../../index.html">Module code</a> &raquo;</li>
      
          <li><a href="../../../../../cloudmesh_client.html">cloudmesh_client</a> &raquo;</li>
      
    <li>cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span>

<span class="kn">from</span> <span class="nn">cloudmesh_client.cloud.iaas.CloudProviderBase</span> <span class="kn">import</span> <span class="n">CloudProviderBase</span>
<span class="kn">from</span> <span class="nn">cloudmesh_client.common.todo</span> <span class="kn">import</span> <span class="n">TODO</span>
<span class="kn">from</span> <span class="nn">cloudmesh_client.common.ConfigDict</span> <span class="kn">import</span> <span class="n">Config</span><span class="p">,</span> <span class="n">ConfigDict</span>
<span class="kn">from</span> <span class="nn">cloudmesh_client.common.FlatDict</span> <span class="kn">import</span> <span class="n">FlatDict</span>
<span class="kn">from</span> <span class="nn">keystoneclient.auth.identity</span> <span class="kn">import</span> <span class="n">v3</span>
<span class="kn">from</span> <span class="nn">keystoneclient</span> <span class="kn">import</span> <span class="n">session</span>
<span class="kn">from</span> <span class="nn">novaclient</span> <span class="kn">import</span> <span class="n">client</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">from</span> <span class="nn">cloudmesh_client.shell.console</span> <span class="kn">import</span> <span class="n">Console</span>

<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>


<span class="c1"># TODO: unset as not allowing to smoothly switch</span>
<div class="viewcode-block" id="set_os_environ"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.set_os_environ">[docs]</a><span class="k">def</span> <span class="nf">set_os_environ</span><span class="p">(</span><span class="n">cloudname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set os environment variables on a given cloudname&quot;&quot;&quot;</span>
    <span class="c1"># TODO: this has a severe bug as it is not unsetting variables</span>
    <span class="c1"># Also this coded duplicates in part from register</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="s2">&quot;cloudmesh.yaml&quot;</span><span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">][</span><span class="s2">&quot;clouds&quot;</span><span class="p">][</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">credentials</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;OS_CACERT&quot;</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">path_expand</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;problem setting env&quot;</span><span class="p">)</span></div>


<span class="c1">#</span>
<span class="c1"># we already have a much better convert to dict function</span>
<span class="c1">#</span>


<span class="c1"># noinspection PyPep8Naming,PyUnusedLocal,PyUnusedLocal</span>
<div class="viewcode-block" id="CloudProviderOpenstackAPI"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI">[docs]</a><span class="k">class</span> <span class="nc">CloudProviderOpenstackAPI</span><span class="p">(</span><span class="n">CloudProviderBase</span><span class="p">):</span>
    <span class="n">cloud_type</span> <span class="o">=</span> <span class="s2">&quot;openstack&quot;</span>
    <span class="n">cloud_pwd</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloud_name</span><span class="p">,</span> <span class="n">cloud_details</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CloudProviderOpenstackAPI</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">cloud_name</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flat</span> <span class="o">=</span> <span class="n">flat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud_type</span> <span class="o">=</span> <span class="s2">&quot;openstack&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="s2">&quot;flavor&quot;</span><span class="p">,</span> <span class="s2">&quot;vm&quot;</span><span class="p">,</span> <span class="s2">&quot;quota&quot;</span><span class="p">,</span> <span class="s2">&quot;limits&quot;</span><span class="p">,</span> <span class="s2">&quot;usage&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbobject</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="s2">&quot;flavor&quot;</span><span class="p">,</span> <span class="s2">&quot;vm&quot;</span><span class="p">,</span> <span class="s2">&quot;quota&quot;</span><span class="p">,</span> <span class="s2">&quot;limits&quot;</span><span class="p">,</span> <span class="s2">&quot;usage&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">provider</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_image</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_flavor</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">cloud_name</span><span class="p">,</span> <span class="n">cloud_details</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">openstack_result</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">openstack_result</span><span class="p">):</span>
            <span class="c1"># print &quot;---&quot;</span>
            <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;links&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;links&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;server__links&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;server__links&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;image__links&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;image__links&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;flavor__links&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;flavor__links&#39;</span><span class="p">]</span>

            <span class="c1"># If flat dict flag set, convert to flatdict</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flat</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">FlatDict</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">index</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;TODO: we only support flat for now&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">_ksv3_auth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">credentials</span><span class="p">):</span>
        <span class="c1"># auth to identity v3</span>

        <span class="c1"># ref: http://docs.openstack.org/developer/python-keystoneclient/api/keystoneclient.auth.identity.v3.html#keystoneclient.auth.identity.v3.Password</span>
        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;auth_url&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;password&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;username&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;user_id&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;user_domain_id&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;user_domain_name&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;trust_id&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;domain_id&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;domain_name&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;project_id&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;project_name&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;project_domain_id&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;project_domain_name&quot;</span><span class="p">]</span>
        <span class="n">authdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># always required</span>
        <span class="n">authdict</span><span class="p">[</span><span class="s2">&quot;auth_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_AUTH_URL&quot;</span><span class="p">]</span>
        <span class="n">authdict</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_PASSWORD&quot;</span><span class="p">]</span>

        <span class="c1"># setting automatically all available ones</span>
        <span class="c1"># CAUTION: MAY be causing conflict/error.</span>
        <span class="c1"># e.g., for jetstream, the OS_USER_DOMAIN_ID=tacc</span>
        <span class="c1"># was causing error (domain not found)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">credentials</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;OS_&quot;</span><span class="p">):</span>
                <span class="n">newkey</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">newkey</span> <span class="ow">in</span> <span class="n">allowed_params</span><span class="p">:</span>
                    <span class="n">authdict</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        # different cloud provider may be using different set of other info</span>
<span class="sd">        # e.g. id or name for project, domain, etc.</span>
<span class="sd">        if &quot;OS_USERNAME&quot; in credentials:</span>
<span class="sd">            authdict[&quot;username&quot;] = credentials[&quot;OS_USERNAME&quot;]</span>
<span class="sd">        if &quot;OS_USER_ID&quot; in credentials:</span>
<span class="sd">            authdict[&quot;user_id&quot;] = credentials[&quot;OS_USER_ID&quot;]</span>
<span class="sd">        if &quot;OS_PROJECT_NAME&quot; in credentials:</span>
<span class="sd">            authdict[&quot;project_name&quot;] = credentials[&quot;OS_PROJECT_NAME&quot;]</span>
<span class="sd">        if &quot;OS_PROJECT_ID&quot; in credentials:</span>
<span class="sd">            authdict[&quot;project_id&quot;] = credentials[&quot;OS_PROJECT_ID&quot;]</span>
<span class="sd">        if &quot;OS_USER_DOMAIN_NAME&quot; in credentials:</span>
<span class="sd">            authdict[&quot;user_domain_name&quot;] = credentials[&quot;OS_USER_DOMAIN_NAME&quot;]</span>
<span class="sd">        elif &quot;OS_USER_DOMAIN_ID&quot; in credentials:</span>
<span class="sd">            authdict[&quot;user_domain_name&quot;] = credentials[&quot;OS_USER_DOMAIN_ID&quot;]</span>
<span class="sd">        if &quot;OS_PROJECT_DOMAIN_NAME&quot; in credentials:</span>
<span class="sd">            authdict[&quot;project_domain_name&quot;] = credentials[&quot;OS_PROJECT_DOMAIN_NAME&quot;]</span>
<span class="sd">        elif &quot;OS_PROJECT_DOMAIN_ID&quot; in credentials:</span>
<span class="sd">            authdict[&quot;project_domain_name&quot;] = credentials[&quot;OS_PROJECT_DOMAIN_ID&quot;]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># pprint(authdict)</span>

        <span class="n">ksauth</span> <span class="o">=</span> <span class="n">v3</span><span class="o">.</span><span class="n">Password</span><span class="p">(</span><span class="o">**</span><span class="n">authdict</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ksauth</span>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.logon"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.logon">[docs]</a>    <span class="k">def</span> <span class="nf">logon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logs onto a cloud</span>
<span class="sd">        :param cloudname:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="s2">&quot;cloudmesh.yaml&quot;</span><span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">][</span><span class="s2">&quot;clouds&quot;</span><span class="p">][</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>

        <span class="n">os_password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_PASSWORD&quot;</span><span class="p">]</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;Password for cloud - {}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cloudname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os_password</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;readline&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;pwd&#39;</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">]:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;pwd&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os_password</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;env&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;pwd&#39;</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">]:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;pwd&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OS_PASSWORD&quot;</span><span class="p">,</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">))</span>

        <span class="c1">#</span>
        <span class="c1"># TODO: pwd is not standing for passwd</span>
        <span class="c1">#</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;pwd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os_password</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Active&quot;</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.activate"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.activate">[docs]</a>    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activates a cloud</span>
<span class="sd">        :param cloudname:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Active&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.deactivate"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.deactivate">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deactivates a cloud</span>
<span class="sd">        :param cloudname:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Inactive&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.logout"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.logout">[docs]</a>    <span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logs out from a cloud</span>
<span class="sd">        :param cloudname:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">cloudname</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_clouds"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_clouds">[docs]</a>    <span class="k">def</span> <span class="nf">list_clouds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists clouds</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cloud_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="s2">&quot;cloudmesh.yaml&quot;</span><span class="p">)</span>
        <span class="n">clouds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">][</span><span class="s2">&quot;clouds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cloud</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clouds</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cloud</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">:</span>
                <span class="n">cloud_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;cloud&quot;</span><span class="p">:</span> <span class="n">cloud</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloud</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cloud_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;cloud&quot;</span><span class="p">:</span> <span class="n">cloud</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Logged Out&quot;</span>
                <span class="p">}</span>

        <span class="k">return</span> <span class="n">cloud_dict</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.initialize"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="s2">&quot;cloudmesh.yaml&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">][</span><span class="s2">&quot;clouds&quot;</span><span class="p">][</span><span class="n">cloudname</span><span class="p">]</span>

        <span class="c1"># pprint(self.cloud_details)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cloud</span> <span class="o">=</span> <span class="n">cloudname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_flavor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">][</span><span class="s2">&quot;flavor&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tenant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span><span class="p">[</span><span class="s1">&#39;credentials&#39;</span><span class="p">][</span><span class="s1">&#39;OS_TENANT_NAME&#39;</span><span class="p">]</span>
        <span class="n">version</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span><span class="p">[</span><span class="s2">&quot;credentials&quot;</span><span class="p">]</span>
        <span class="n">cert</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="s2">&quot;OS_CACERT&quot;</span> <span class="ow">in</span> <span class="n">credentials</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_CACERT&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">cert</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">path_expand</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_CACERT&quot;</span><span class="p">])</span>
        <span class="n">auth_url</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_AUTH_URL&quot;</span><span class="p">]</span>
        <span class="n">ksversion</span> <span class="o">=</span> <span class="n">auth_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        # GitHub issue 101</span>
<span class="sd">        # mechanism to interactively ask for password</span>
<span class="sd">        # when OS_PASSWORD set as &quot;readline&quot;,</span>
<span class="sd">        # or read os.environ if set as &quot;env&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os_password</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_PASSWORD&quot;</span><span class="p">]</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;Password for cloud - {}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cloudname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os_password</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;readline&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="s2">&quot;tbd&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">cloudname</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span> <span class="ow">and</span> \
                        <span class="s1">&#39;pwd&#39;</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">]:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;pwd&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os_password</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;env&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cloudname</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span> <span class="ow">and</span> \
                        <span class="s1">&#39;pwd&#39;</span> <span class="ow">in</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">]:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;pwd&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os_password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OS_PASSWORD&quot;</span><span class="p">,</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">))</span>

        <span class="c1"># store the password for this session</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;pwd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os_password</span>
        <span class="n">CloudProviderOpenstackAPI</span><span class="o">.</span><span class="n">cloud_pwd</span><span class="p">[</span><span class="n">cloudname</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Active&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;v2.0&quot;</span> <span class="o">==</span> <span class="n">ksversion</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">provider</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
                <span class="n">version</span><span class="p">,</span>
                <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_USERNAME&quot;</span><span class="p">],</span>
                <span class="n">os_password</span><span class="p">,</span>
                <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_TENANT_NAME&quot;</span><span class="p">],</span>
                <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;OS_AUTH_URL&quot;</span><span class="p">],</span>
                <span class="n">cert</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;v3&quot;</span> <span class="o">==</span> <span class="n">ksversion</span><span class="p">:</span>
            <span class="n">sess</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ksv3_auth</span><span class="p">(</span><span class="n">credentials</span><span class="p">),</span>
                                   <span class="n">verify</span><span class="o">=</span><span class="n">cert</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">provider</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">sess</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.mode"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.mode">[docs]</a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the source for the information to be returned. &quot;db&quot; and &quot;cloud&quot;</span>
<span class="sd">        :param source: the database can be queried in mode &quot;db&quot;,</span>
<span class="sd">        the database can be bypassed in mode &quot;cloud&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">TODO</span><span class="o">.</span><span class="n">implement</span><span class="p">()</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_key"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_key">[docs]</a>    <span class="k">def</span> <span class="nf">list_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># TODO: this needs to be move to the provider</span>
        <span class="n">_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">keypairs</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>

        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">_keys</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">_keys</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>

            <span class="c1"># key[&quot;type&quot;], key[&quot;string&quot;], key[&quot;comment&quot;] = (key[&quot;keypair__public_key&quot;] + &quot; &quot;).split(&quot; &quot;, 3)</span>
            <span class="c1"># key[&quot;comment&quot;] = key[&quot;comment&quot;].strip()</span>
            <span class="n">key_segments</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="s2">&quot;keypair__public_key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">key</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">key</span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_segments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">key</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_segments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">key</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_segments</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_segments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">key</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key_segments</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

        <span class="k">return</span> <span class="n">_keys</span></div>
        <span class="c1"># return self._to_dict(self.provider.keypairs.list())</span>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_flavor"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_flavor">[docs]</a>    <span class="k">def</span> <span class="nf">list_flavor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_image"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_image">[docs]</a>    <span class="k">def</span> <span class="nf">list_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;server__links&#39;</span> <span class="ow">in</span> <span class="n">o</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;server__links&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_secgroup"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">list_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">security_groups</span><span class="o">.</span><span class="n">list</span><span class="p">())</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_secgroup_rules"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_secgroup_rules">[docs]</a>    <span class="k">def</span> <span class="nf">list_secgroup_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">):</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_secgroup</span><span class="p">(</span><span class="n">cloudname</span><span class="p">)</span>

        <span class="n">rules</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;rules&quot;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;ip_protocol&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

                    <span class="n">element</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;fromPort&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;from_port&quot;</span><span class="p">],</span>
                        <span class="s1">&#39;toPort&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">[</span><span class="s2">&quot;to_port&quot;</span><span class="p">],</span>
                        <span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                        <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;ip_protocol&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;ruleid&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;groupid&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;parent_group_id&#39;</span><span class="p">]</span>
                    <span class="p">}</span>

                    <span class="k">if</span> <span class="s1">&#39;cidr&#39;</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;ip_range&#39;</span><span class="p">]:</span>
                        <span class="n">element</span><span class="p">[</span><span class="s1">&#39;ipRange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;ip_range&#39;</span><span class="p">][</span><span class="s1">&#39;cidr&#39;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">element</span><span class="p">[</span><span class="s1">&#39;ip_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rules</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.create_secgroup"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.create_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">create_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secgroup_name</span><span class="p">):</span>
        <span class="n">secgroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">security_groups</span> \
            <span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">secgroup_name</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Security group {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">secgroup_name</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">secgroup</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.add_secgroup_rule"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.add_secgroup_rule">[docs]</a>    <span class="k">def</span> <span class="nf">add_secgroup_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">rule_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">security_group_rules</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">],</span>
                                                            <span class="n">ip_protocol</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;protocol&quot;</span><span class="p">],</span>
                                                            <span class="n">from_port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;from_port&quot;</span><span class="p">],</span>
                                                            <span class="n">to_port</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;to_port&quot;</span><span class="p">],</span>
                                                            <span class="n">cidr</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cidr&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">rule_id</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.delete_secgroup"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.delete_secgroup">[docs]</a>    <span class="k">def</span> <span class="nf">delete_secgroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">security_groups</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">groups</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sec_group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>

                <span class="c1"># delete the secgroup in the cloud</span>
                <span class="k">if</span> <span class="n">sec_group</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">security_groups</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">sec_group</span><span class="p">)</span>
                        <span class="n">Console</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;Secgroup delete: {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sec_group</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">sec_group</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]))</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">traceflag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                        <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Secgroup delete: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sec_group</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">traceflag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Could not find security group [{}] in cloud [{}]&quot;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.delete_secgroup_rule"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.delete_secgroup_rule">[docs]</a>    <span class="k">def</span> <span class="nf">delete_secgroup_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule_id</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">security_group_rules</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">rule_id</span><span class="p">)</span></div>
        <span class="c1">#return</span>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_vm">[docs]</a>    <span class="k">def</span> <span class="nf">list_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">vm_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>

        <span class="c1"># Extracting and modifying dict with IP details as per the model requirement.</span>
        <span class="n">ip_detail_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">secgroup_list_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">:</span>
            <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;floating_ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;static_ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;addresses&quot;</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">ip_detail</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">key</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">ip_detail</span><span class="p">[</span><span class="s2">&quot;OS-EXT-IPS:type&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">ip_detail</span><span class="p">[</span><span class="s2">&quot;OS-EXT-IPS:type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
                                <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;static_ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip_detail</span><span class="p">[</span><span class="s2">&quot;addr&quot;</span><span class="p">]</span>
                            <span class="k">elif</span> <span class="n">ip_detail</span><span class="p">[</span><span class="s2">&quot;OS-EXT-IPS:type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;floating&quot;</span><span class="p">:</span>
                                <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;floating_ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip_detail</span><span class="p">[</span><span class="s2">&quot;addr&quot;</span><span class="p">]</span>

            <span class="n">secgroup_list_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="n">sec_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="s2">&quot;security_groups&quot;</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">secgroup</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;security_groups&quot;</span><span class="p">]:</span>
                    <span class="n">secgroup_list_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="n">secgroup</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="n">sec_index</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># Append comma if not the last element</span>
                    <span class="k">if</span> <span class="n">sec_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;security_groups&quot;</span><span class="p">]):</span>
                        <span class="n">secgroup_list_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span>

        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">:</span>
            <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;floating_ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;floating_ip&quot;</span><span class="p">]</span>
            <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;static_ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip_detail_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">&quot;static_ip&quot;</span><span class="p">]</span>
            <span class="n">vm_dict</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">u&quot;security_ groups&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">secgroup_list_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">vm_dict</span><span class="p">:</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">vm_dict</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;server_links&#39;</span><span class="p">,</span> <span class="s1">&#39;flavor__links&#39;</span><span class="p">,</span> <span class="s1">&#39;image__links&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">o</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">o</span><span class="p">[</span><span class="n">link</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">vm_dict</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.rename_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.rename_vm">[docs]</a>    <span class="k">def</span> <span class="nf">rename_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renames a vm.</span>
<span class="sd">        :param current_name:</span>
<span class="sd">        :param new_name:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">current_name</span><span class="p">):</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">current_name</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Renaming VM ({})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">current_name</span><span class="p">))</span>
            <span class="n">server</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># server = self.provider.servers.find(name=name)</span>
            <span class="n">search_opts</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">current_name</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">vms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">search_opts</span><span class="o">=</span><span class="n">search_opts</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">vm</span> <span class="ow">in</span> <span class="n">vms</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Renaming VM ({}) : {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="n">vm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">new_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_limits"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_limits">[docs]</a>    <span class="k">def</span> <span class="nf">list_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tenant</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">limits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tenant_id</span><span class="o">=</span><span class="n">tenant</span><span class="p">)</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_floating_ips"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_floating_ips">[docs]</a>    <span class="k">def</span> <span class="nf">list_floating_ips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">list</span><span class="p">())</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_floating_ip_pools"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_floating_ip_pools">[docs]</a>    <span class="k">def</span> <span class="nf">list_floating_ip_pools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ip_pools</span><span class="o">.</span><span class="n">list</span><span class="p">())</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_quota"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_quota">[docs]</a>    <span class="k">def</span> <span class="nf">list_quota</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># pprint(self.provider.__dict__)</span>
        <span class="c1"># pprint(dir(self.provider.quotas))</span>
        <span class="n">tenant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_details</span><span class="p">[</span><span class="s2">&quot;credentials&quot;</span><span class="p">][</span><span class="s2">&quot;OS_TENANT_NAME&quot;</span><span class="p">]</span>
        <span class="c1"># print (tenant)</span>
        <span class="c1"># pprint(self.provider.quotas.defaults(tenant))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">quotas</span><span class="o">.</span><span class="n">defaults</span><span class="p">(</span><span class="n">tenant</span><span class="p">)</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_usage"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_usage">[docs]</a>    <span class="k">def</span> <span class="nf">list_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cloudname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;list usage is not supported&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.list_console"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.list_console">[docs]</a>    <span class="k">def</span> <span class="nf">list_console</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">get_console_output</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.boot_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.boot_vm">[docs]</a>    <span class="k">def</span> <span class="nf">boot_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">group</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">flavor</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">cloud</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">secgroup</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">meta</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">nics</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spawns a VM instance on the cloud.</span>
<span class="sd">        If image and flavor passed as none, it would consider the defaults specified in cloudmesh.yaml.</span>

<span class="sd">        :param name: Name of the instance to be started</span>
<span class="sd">        :param image: Image id to be used for the instance</span>
<span class="sd">        :param flavor: Flavor to be used for the instance</span>
<span class="sd">        :param cloud: Cloud on which to spawn the machine. Defaults to &#39;India&#39;.</span>
<span class="sd">        :param key: Key to be used for the instance</span>
<span class="sd">        :param secgroup: Security group for the instance</span>
<span class="sd">        :param meta: A dict of arbitrary key/value metadata to store for this server</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">cloud</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cloud is not specified&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">image</span> <span class="o">=</span> <span class="n">image</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_image</span>
        <span class="n">flavor</span> <span class="o">=</span> <span class="n">flavor</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_flavor</span>

        <span class="n">image_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_image_id</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">flavor_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flavor_id</span><span class="p">(</span><span class="n">flavor</span><span class="p">)</span>

        <span class="c1"># if no nics specified, try to find one in case it&#39;s needed</span>
        <span class="k">if</span> <span class="n">nics</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">nics</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nics</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nics</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;net-id&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="c1"># get net-id based on tenant network name, and other possible</span>
            <span class="c1"># default network names</span>
            <span class="n">netnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;{0}-net&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tenant</span><span class="p">),</span> <span class="s2">&quot;int-net&quot;</span><span class="p">]</span>
            <span class="n">nicsmy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">networks</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">netname</span> <span class="ow">in</span> <span class="n">netnames</span><span class="p">:</span>
                <span class="n">nic</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nicsmy</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">netname</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nic</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># found and break out of loop</span>
                    <span class="c1"># use the value found here</span>
                    <span class="n">nic</span> <span class="o">=</span> <span class="n">nic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">nics</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;net-id&quot;</span><span class="p">:</span> <span class="n">nic</span><span class="o">.</span><span class="n">id</span><span class="p">}]</span>
                    <span class="k">break</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create(name, image, flavor, meta=None, files=None, reservation_id=None, min_count=None, max_count=None,</span>
<span class="sd">          security_groups=None, userdata=None, key_name=None, availability_zone=None, block_device_mapping=None,</span>
<span class="sd">          block_device_mapping_v2=None, nics=None, scheduler_hints=None, config_drive=None, disk_config=None,</span>
<span class="sd">          admin_pass=None, access_ip_v4=None, access_ip_v6=None, **kwargs)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;image_id&quot;</span><span class="p">:</span> <span class="n">image_id</span><span class="p">,</span>
            <span class="s2">&quot;flavor_id&quot;</span><span class="p">:</span> <span class="n">flavor_id</span><span class="p">,</span>
            <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="n">meta</span><span class="p">,</span>
            <span class="s2">&quot;key_name&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span>
            <span class="s2">&quot;security_groups&quot;</span><span class="p">:</span> <span class="n">secgroup</span><span class="p">,</span>
            <span class="s2">&quot;nics&quot;</span><span class="p">:</span> <span class="n">nics</span><span class="p">}</span>
        <span class="c1"># pprint (d)</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                                                  <span class="n">image_id</span><span class="p">,</span>
                                                  <span class="n">flavor_id</span><span class="p">,</span>
                                                  <span class="n">meta</span><span class="o">=</span><span class="n">meta</span><span class="p">,</span>
                                                  <span class="n">key_name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                                                  <span class="n">security_groups</span><span class="o">=</span><span class="n">secgroup</span><span class="p">,</span>
                                                  <span class="n">nics</span><span class="o">=</span><span class="n">nics</span><span class="p">)</span>
            <span class="c1"># return the server id</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="nb">id</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Invalid key_name provided.&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid key provided. &quot;</span>
                              <span class="s2">&quot;Is the key loaded, the default key set properly and uploaded to the cloud?&quot;</span><span class="p">,</span>
                              <span class="n">traceflag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Problem starting vm&quot;</span><span class="p">,</span> <span class="n">traceflag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">Console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">id</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.delete_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.delete_vm">[docs]</a>    <span class="k">def</span> <span class="nf">delete_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a machine on the target cloud indicated by the id or name</span>
<span class="sd">        :param name: Name or ID of the instance to be deleted</span>
<span class="sd">        :param group: Security group of the instance to be deleted</span>
<span class="sd">        :param force: Force delete option</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># server = self.provider.servers.find(name=name)</span>
            <span class="n">search_opts</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">vms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">search_opts</span><span class="o">=</span><span class="n">search_opts</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">vm</span> <span class="ow">in</span> <span class="n">vms</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Deleting VM ({}) : {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vm</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vm</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="n">vm</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.delete_floating_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.delete_floating_ip">[docs]</a>    <span class="k">def</span> <span class="nf">delete_floating_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">floating_ip</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method deletes a floating IP address</span>
<span class="sd">        :param floating_ip:</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">floating_ip</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.start_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.start_vm">[docs]</a>    <span class="k">def</span> <span class="nf">start_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a suspended machine on the target cloud indicated by the id or name</span>
<span class="sd">        :param name: Name or ID of the instance to be deleted</span>
<span class="sd">        :param group: Security group of the instance to be deleted</span>
<span class="sd">        :param force: Force delete option</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.stop_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.stop_vm">[docs]</a>    <span class="k">def</span> <span class="nf">stop_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops a machine on the target cloud indicated by the id or name</span>
<span class="sd">        :param name: Name or ID of the instance to be deleted</span>
<span class="sd">        :param group: Security group of the instance to be deleted</span>
<span class="sd">        :param force: Force delete option</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="n">server</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_ips"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_ips">[docs]</a>    <span class="k">def</span> <span class="nf">get_ips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the ip of the instance indicated by name</span>
<span class="sd">        :param name:</span>
<span class="sd">        :param group:</span>
<span class="sd">        :param force:</span>
<span class="sd">        :return: IP address of the instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">ips</span><span class="p">(</span><span class="n">server</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_floating_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_floating_ip">[docs]</a>    <span class="k">def</span> <span class="nf">get_floating_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">floating_ip_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the floating ip info associated with floating_ip_id</span>
<span class="sd">        :param floating_ip_id:</span>
<span class="sd">        :return: floating ip info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">float_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">floating_ip_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">float_ip</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_fixed_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_fixed_ip">[docs]</a>    <span class="k">def</span> <span class="nf">get_fixed_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixed_ip_addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the fixed ip info associated with fixed ip addr</span>
<span class="sd">        :param fixed_ip_addr:</span>
<span class="sd">        :return: fixed ip info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fixed_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">fixed_ips</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fixed_ip_addr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fixed_ip</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.reserve_fixed_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.reserve_fixed_ip">[docs]</a>    <span class="k">def</span> <span class="nf">reserve_fixed_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixed_ip_addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reserves a fixed ip address</span>
<span class="sd">        :param fixed_ip_addr:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">fixed_ips</span><span class="o">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">fixed_ip_addr</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.unreserve_fixed_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.unreserve_fixed_ip">[docs]</a>    <span class="k">def</span> <span class="nf">unreserve_fixed_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fixed_ip_addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unreserves a fixed ip address</span>
<span class="sd">        :param fixed_ip_addr:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">fixed_ips</span><span class="o">.</span><span class="n">unreserve</span><span class="p">(</span><span class="n">fixed_ip_addr</span><span class="p">)</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.create_assign_floating_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.create_assign_floating_ip">[docs]</a>    <span class="k">def</span> <span class="nf">create_assign_floating_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function creates a new floating ip and associates it with the machine specified.</span>
<span class="sd">        :param server_name: Name of the machine to which the floating ip needs to be assigned.</span>
<span class="sd">        :return: Floating IP | None if floating ip already assigned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">allocated_ips</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_floating_ips</span><span class="p">()</span>
        <span class="n">fip</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ipobj</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">allocated_ips</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">ipobj</span><span class="p">[</span><span class="s1">&#39;instance_id&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">fip</span> <span class="o">=</span> <span class="n">ipobj</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fip</span><span class="p">:</span>
            <span class="n">float_pool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ip_pools</span><span class="o">.</span><span class="n">list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">floating_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="n">float_pool</span><span class="p">)</span>
                <span class="n">fip</span> <span class="o">=</span> <span class="n">floating_ip</span><span class="o">.</span><span class="n">ip</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;Error: No more floating ips available&quot;</span>
        <span class="k">if</span> <span class="n">fip</span><span class="p">:</span>
            <span class="n">server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">server_name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">server</span><span class="o">.</span><span class="n">add_floating_ip</span><span class="p">(</span><span class="n">fip</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">floating_ip</span><span class="p">)</span>

            <span class="n">ret</span> <span class="o">=</span> <span class="n">fip</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;Error: failed to create floatingip&quot;</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.add_key_to_cloud"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.add_key_to_cloud">[docs]</a>    <span class="k">def</span> <span class="nf">add_key_to_cloud</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to add key to cloud, typically a keypair for openstack.</span>
<span class="sd">        :param name: Name of the keypair.</span>
<span class="sd">        :param public_key: public key string.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># print(&quot;Name=&quot; + name)</span>
        <span class="c1"># print(&quot;public_key=&quot; + public_key)</span>

        <span class="n">keypair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">keypairs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">public_key</span><span class="o">=</span><span class="n">public_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">keypair</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.delete_key_from_cloud"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.delete_key_from_cloud">[docs]</a>    <span class="k">def</span> <span class="nf">delete_key_from_cloud</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to delete key from cloud, typically a keypair for openstack.</span>
<span class="sd">        :param name: Name of the keypair.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># print(&quot;Name=&quot; + name)</span>
        <span class="c1"># print(&quot;public_key=&quot; + public_key)</span>

        <span class="n">keypair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">keypairs</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">keypair</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.create_floating_ip"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.create_floating_ip">[docs]</a>    <span class="k">def</span> <span class="nf">create_floating_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_pool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method creates a new floating ip under the specified pool</span>
<span class="sd">        :param float_pool:</span>
<span class="sd">        :return: Floating IP</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">floating_ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">floating_ips</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pool</span><span class="o">=</span><span class="n">float_pool</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">floating_ip</span><span class="o">.</span><span class="n">ip</span></div>

    <span class="c1"># TODO: define this</span>
    <span class="c1"># noinspection PyProtectedMember,PyProtectedMember</span>
<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_image"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_image">[docs]</a>    <span class="k">def</span> <span class="nf">get_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        finds the image based on a query</span>
<span class="sd">        TODO: details TBD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">_info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">_info</span></div>

    <span class="c1"># TODO: define this</span>
    <span class="c1"># noinspection PyProtectedMember,PyProtectedMember</span>
<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_image_id"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_image_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_image_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        finds the image based on a query</span>
<span class="sd">        TODO: details TBD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_flavor_id"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_flavor_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_flavor_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        finds the image based on a query</span>
<span class="sd">        TODO: details TBD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flavor</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">name</span><span class="p">)[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.isUuid"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.isUuid">[docs]</a>    <span class="k">def</span> <span class="nf">isUuid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">UUID</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span></div>

    <span class="c1"># noinspection PyProtectedMember</span>
<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_flavor"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_flavor">[docs]</a>    <span class="k">def</span> <span class="nf">get_flavor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        finds the flavor based on a query</span>
<span class="sd">        TODO: details TBD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">_info</span></div>

    <span class="c1"># noinspection PyProtectedMember,PyProtectedMember</span>
<div class="viewcode-block" id="CloudProviderOpenstackAPI.get_vm"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.get_vm">[docs]</a>    <span class="k">def</span> <span class="nf">get_vm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        finds the flavor based on a query</span>
<span class="sd">        TODO: details TBD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vm_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isUuid</span><span class="p">(</span><span class="n">vm_name</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vm_name</span><span class="p">)</span><span class="o">.</span><span class="n">_info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">servers</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">vm_name</span><span class="p">,</span>
                                              <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">_info</span></div>

<div class="viewcode-block" id="CloudProviderOpenstackAPI.attributes"><a class="viewcode-back" href="../../../../../../code/cloudmesh_client.cloud.iaas.provider.openstack.html#cloudmesh_client.cloud.iaas.provider.openstack.CloudProviderOpenstackAPI.CloudProviderOpenstackAPI.attributes">[docs]</a>    <span class="k">def</span> <span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;flavor&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;cm_id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="c1">#&#39;user&#39;,</span>
                    <span class="s1">&#39;ram&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;os_flv_disabled&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;vcpus&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;swap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;os_flavor_acces&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;rxtx_factor&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;os_flv_ext_data&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;disk&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;updated_at&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;Id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                    <span class="c1">#&#39;User&#39;,</span>
                    <span class="s1">&#39;RAM&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Disabled&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;vCPUs&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Swap&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Access&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;rxtx_factor&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;os_flv_ext_data&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Disk&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Cloud&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;updated&#39;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;cm_id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;os_image_size&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;metadata__description&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;minDisk&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;minRam&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;size&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;minDisk&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;minRam&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;cloud&#39;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;vm&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;cm_id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;group&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;static_ip&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;floating_ip&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;image&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;flavor&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;username&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;key&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;project&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;updated_at&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;user&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;group&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;static_ip&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;floating_ip&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;username&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;image&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;flavor&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;key&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;project&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;cloud&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;updated_at&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;user&#39;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;static_ip&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;floating_ip&#39;</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;static_ip&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;floating_ip&#39;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;floating_ip&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;instance_name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ip&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;pool&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;fixed_ip&quot;</span><span class="p">,</span>
                    <span class="c1"># &quot;id&quot;,</span>
                    <span class="c1"># &quot;instance_id&quot;,</span>
                    <span class="s1">&#39;cloud&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;instance_name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;floating_ip&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;floating_ip_pool&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;fixed_ip&quot;</span><span class="p">,</span>
                    <span class="c1"># &quot;floating_ip_id&quot;,</span>
                    <span class="c1"># &quot;instance_id&quot;,</span>
                    <span class="s1">&#39;cloud&#39;</span>
                <span class="p">],</span>
            <span class="p">},</span>
            <span class="s1">&#39;floating_ip_pool&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;name&quot;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;floating_ip_pool&quot;</span>
                <span class="p">],</span>
            <span class="p">},</span>
            <span class="s1">&#39;clouds&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;cloud&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;default&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;key&quot;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Cloud&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Default&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Key&quot;</span>
                <span class="p">],</span>
            <span class="p">},</span>
            <span class="s1">&#39;limits&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Value&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Value&#39;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;quota&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;Quota&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Limit&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;Quota&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Limit&#39;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;secgroup&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;cm_id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;group&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;user&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;project&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;uuid&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;Id&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Group&#39;</span>
                    <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;User&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Tenant&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Uuid&#39;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;user&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;value&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;created_at&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;updated_at&#39;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;user&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;value&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;created_at&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;updated_at&#39;</span>
                <span class="p">],</span>
            <span class="p">},</span>
            <span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;member&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;user&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;category&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">]</span>

            <span class="p">},</span>
            <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s1">&#39;category&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;keypair__name&#39;</span><span class="p">,</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;comment&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;keypair__fingerprint&quot;</span>
                <span class="p">],</span>
                <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Category&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Comment&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Fingerprint&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">layout</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">layout</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s2">&quot;order&quot;</span><span class="p">]</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">layout</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s2">&quot;header&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="n">order</span><span class="p">,</span> <span class="n">header</span></div></div>


<span class="c1"># CloudProviderBase.register(CloudProviderOpenstackAPI)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">cloudname</span> <span class="o">=</span> <span class="s1">&#39;kilo&#39;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="s2">&quot;cloudmesh.yaml&quot;</span><span class="p">)</span>
    <span class="n">cloud_details</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;cloudmesh&quot;</span><span class="p">][</span><span class="s2">&quot;clouds&quot;</span><span class="p">][</span><span class="n">cloudname</span><span class="p">]</span>

    <span class="n">cp</span> <span class="o">=</span> <span class="n">CloudProviderOpenstackAPI</span><span class="p">(</span><span class="n">cloudname</span><span class="p">,</span> <span class="n">cloud_details</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;390792c3-66a0-4c83-a0d7-c81e1c787710&#39;</span><span class="p">}</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">list_quota</span><span class="p">(</span><span class="n">cloudname</span><span class="p">))</span>

    <span class="n">pprint</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">list_key</span><span class="p">(</span><span class="n">cloudname</span><span class="p">))</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Gregor von Laszewski.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../',
            VERSION:'4.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>